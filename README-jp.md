MitM PoC
=======

MitMでApplicationCacheを汚染し、汚染された端末が安全なネットワークへ移動した後にネットワーク内の機器へbrute force攻撃を仕掛けるコードのデモです。

Android 4.1.1のAdMobが入ったネイティブアプリの広告領域で動作を確認しています。

普通のブラウザ上ではBasic認証のダイアログが出るので攻撃が成立しません。  
（通常のブラウザでもBasic認証の認証失敗時にダイアログを出さない方法がある場合、攻撃が可能になります）

シナリオ
-------

1. ruby proxy.rbを実行
2. 技術系イベント、公衆無線LAN等のSSID, passが公開されたAPのそばに、同じSSID, passで攻撃用APを設置
3. 接続してきた機器の通信をlocalhost 5432へリダイレクト
4. 攻撃者のサーバで内部ネットワーク機器の認証後画面が送られてくるのを待つ

その他
-------

通信をリダイレクトする方法は透過プロキシを使用するか、dhcpでプロキシ設定を配布することを想定  
（詳細はdhcp.confとproxy.pacに記載）

AdMob以外でもネイティブアプリ内のWebViewで固定URLを使用している場合、攻撃可能

この攻撃コードについて
-------

簡単な攻撃は行うが、外部サーバへのログの送信は行わない

攻撃対象のIPは各種ルータのIPとして設定される可能性が高いIPを恣意的に選択

brute force攻撃ではなく、各種ルータの初期値として設定されている可能性が高い認証情報のリスト攻撃

キャッシュ汚染から3日経過後に攻撃を仕掛けるが、[RTCPeerConnectionを使うことでローカルIPが取得できる](http://jsfiddle.net/wzh2C/)ため、将来的に「ローカルIPが変わった（=別のネットワークへ移動した）」ことを検知して攻撃を仕掛けることか可能  
（iOS 7、Android 4.1.1 WebViewではRTCPeerConnectionは動作しない）

